http://sqlfiddle.com/#!2/2e406